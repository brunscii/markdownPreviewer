<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <!-- <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script> -->
    <!-- <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script> -->
    <!-- <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.2.2/marked.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="purify.js"></script>
    <title>Markdown Previewer</title>
    
    <!-- <script src="<script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script> -->
    <!-- <script src="index.js"></script> -->
</head>
    <body >


    <h1>Markdown to HTML previwer</h1>
    
    <div class="dBox">

        <label class="box-title" for="editor">Markdown</label>
<!-- #region Markdown Preview---------------------------------------------------------------- -->
        <textarea name="markdown-text" id="editor" cols="30" rows="50" spellcheck="false">
# This is a H1
## This is a H2
[this is a link to freeCodeCamp](https://freeCodeCamp.org)
![This is gitHubs octocat](https://myoctocat.com/assets/images/base-octocat.svg)


>Block Quotes

~strikethorugh~

`inline-code`

```c++
    int main(){
        return 0;
    }
```
Here is a list
1. This
- is
+ a
* **list**
        </textarea>
<!-- #end region Markdown Preview---------------------------------------------------------------- -->

        <label class='box-title' for="preview">Preview</label>
        <div name="preview" id="preview" ></div>
    </div>
    <!-- End of markdown previewer -->

    <!-- All we need to do is:
        1) add the event listeners for loading the page and for when input is typed into the markdown textarea
        2) make sure no malicious code is injected using DOMpurify
        3) use the marked library to parse the purified data from the input box and pass it into the previewer div's innerHTML attribute
    -->
    <script>

        // The options for marked to use github format markdown and to convert line breaks
        const options = {
            gfm: true,
            breaks: true
        }

        // DOMPurify.sanitize(marked.parse(`<img src="x" onerror="alert('not happening')">`));
        window.onload = ()=>{
            $('#preview')[0].innerHTML = DOMPurify.sanitize(marked.parse( $('#editor')[0].textContent,options ));
        }
        
        $('#editor')[0].addEventListener('input',(e)=>{
            // console.log(ed.textContent)    
            $('#preview')[0].innerHTML = DOMPurify.sanitize(marked.parse( e.target.value, options ));
        })

    </script>
    </body>
</html>